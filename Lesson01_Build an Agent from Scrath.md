### æœ¬è¯¾ä¸»è¦å­¦ä¹ äº† ReAct-style Agent

![ReAct Agent](./screenshots/001.png)
![Break Down](./screenshots/002.png)

| ReAct ç‰¹å¾                         | ä½ æœ‰æ²¡æœ‰å®ç°ï¼Ÿ                                 | è¯´æ˜ |
| ---------------------------------- | ---------------------------------------------- | ---- |
| ğŸ” Reasoning trace (`Thought:`)    | âœ… æ¨¡å‹ prompt ä¸­å·²å®šä¹‰æ ¼å¼                    |      |
| âš™ï¸ Action æŒ‡ä»¤è¾“å‡º (`Action: xxx`) | âœ… ç”¨ regex è‡ªåŠ¨æå–                           |      |
| ğŸ”§ Tool dispatching                | âœ… `known_actions[action](action_input)`       |      |
| ğŸ‘ï¸ Observation åé¦ˆ                | âœ… å›ä¼  `"Observation: ..."` ç»™æ¨¡å‹            |      |
| ğŸ” å¤šè½®å¯¹è¯å¾ªç¯                    | âœ… ç”¨ `while i < max_turns` å®ç°äº†å¯¹è¯æ§åˆ¶     |      |
| ğŸ”’ å®‰å…¨æ§åˆ¶                        | âš ï¸ `eval()` å­˜åœ¨é£é™©ï¼ˆä»…å»ºè®®åœ¨å—æ§ç¯å¢ƒä¸‹ä½¿ç”¨ï¼‰ |      |
| âœ… Tool registry                   | âœ… `known_actions = {...}` æ˜¾å¼ç®¡ç†å·¥å…·æ˜ å°„    |      |
| ğŸ“œ Prompt æ¨¡æ¿è®¾å®š                 | âœ… ç²¾å¿ƒè®¾è®¡äº† ReAct æŒ‡ä»¤å¼ prompt              |      |
| ğŸ§  Agent çŠ¶æ€ç»´æŠ¤                  | âœ… `self.messages` ä¸­å®Œæ•´ä¿å­˜å†å²ä¸Šä¸‹æ–‡        |      |

æ€»ä½“æ¶æ„å›é¡¾
ä½ å®ç°çš„é€»è¾‘éµå¾ªäº† ReAct çš„æ ‡å‡†ç»“æ„ï¼š

```css
User â†’ LM (Thought â†’ Action â†’ PAUSE) â†’ Tool â†’ Observation â†’ LM â†’ Answer
```

æ¯è½®å¾ªç¯ï¼š

- LLM åˆ¤æ–­é—®é¢˜ â†’ è¾“å‡ºè¡ŒåŠ¨ â†’ åœæ­¢ï¼ˆPAUSEï¼‰
- å·¥å…·æ‰§è¡Œ â†’ äº§ç”Ÿ observation
- observation å›ä¼ ç»™ LLM â†’ å†æ¬¡ Reason or Answer

è¿™å°±æ˜¯ ReAct ç²¾é«“æ‰€åœ¨ âœ…

### ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºä¸‰ç§è§’è‰², systemï¼Œuser å’Œ assistant

âœ… ä¸‰ç§è§’è‰²è§£é‡Š

1. system
   å®šä¹‰ assistant çš„è¡Œä¸ºã€èº«ä»½ã€è¯­æ°”ã€çŸ¥è¯†èŒƒå›´ç­‰
   é€šå¸¸åœ¨å¯¹è¯å¼€å§‹æ—¶ç»™å‡ºï¼Œä¸€èˆ¬åªå‡ºç°ä¸€æ¬¡
   å¸®åŠ©æ¨¡å‹â€œè¿›å…¥è§’è‰²â€ï¼Œä¸ºæ•´ä¸ªå¯¹è¯å®šä¸‹åŸºè°ƒ

ç¤ºä¾‹ï¼š

```json
{ "role": "system", "content": "You are a helpful travel assistant." }
```

2. user
   ä»£è¡¨ç”¨æˆ·è¾“å…¥ï¼ˆä½ çš„é—®é¢˜ã€è¯·æ±‚ã€å‘½ä»¤ï¼‰
   å¯ä»¥å¤šæ¬¡å‡ºç°ï¼Œæ„æˆå¯¹è¯å†…å®¹çš„æ ¸å¿ƒ

ç¤ºä¾‹ï¼š

```json
{ "role": "user", "content": "What's the weather like in Sydney today?" }
```

3. assistant
   è¡¨ç¤ºæ¨¡å‹ï¼ˆä¹Ÿå°±æ˜¯ GPTï¼‰ç”Ÿæˆçš„å›ç­”
   æ¯æ¬¡ chat.completions.create() è¿”å›çš„ç»“æœï¼Œéƒ½ä¼šä»¥ role="assistant" çš„å½¢å¼åŠ å…¥å¯¹è¯å†å²
   å› ä¸º LLM æ˜¯æ— çŠ¶æ€çš„ â€”â€” æ¯æ¬¡è°ƒç”¨éƒ½éœ€è¦ä½ æä¾›å®Œæ•´çš„ä¸Šä¸‹æ–‡ï¼ˆåŒ…æ‹¬å†å²é—®ç­”ï¼‰ï¼Œæ¨¡å‹æ‰çŸ¥é“å®ƒâ€œä¹‹å‰è¯´äº†ä»€ä¹ˆâ€ã€‚
   æ¨¡å‹ä¼šæ ¹æ® æ‰€æœ‰è¿™äº› historyï¼ˆåŒ…æ‹¬ assistant çš„å†å²å›ç­”ï¼‰ æ¥å†³å®šå¦‚ä½•å›åº”æœ€åä¸€æ¡ user é—®å¥

ç¤ºä¾‹ï¼š

```json
{ "role": "assistant", "content": "It's sunny and 25Â°C in Sydney today." }
```

ğŸ“š ä¸ºä»€ä¹ˆè¦åŒºåˆ†è¿™ä¸‰ç§è§’è‰²ï¼Ÿ
| åŸå›  | è¯´æ˜ |
| --------- | ------------------------------------------------- |
| ğŸ­ æ˜ç¡®èº«ä»½ | å¸®åŠ©æ¨¡å‹çŸ¥é“è‡ªå·±æ˜¯è°ï¼ˆassistantï¼‰ã€è°åœ¨è¯´è¯ï¼ˆuserï¼‰ã€æœ‰ä»€ä¹ˆè®¾å®šï¼ˆsystemï¼‰ |
| ğŸ§  æä¾›ä¸Šä¸‹æ–‡ | æ¨¡å‹æ˜¯é€šè¿‡â€œä¸Šä¸‹æ–‡æç¤ºâ€æ¥ç†è§£ä»»åŠ¡å’Œå¯¹è¯å†å²çš„ï¼ŒåŒºåˆ†è§’è‰²èƒ½æä¾›ç»“æ„åŒ–ä¸Šä¸‹æ–‡ |
| ğŸ’¬ æ”¯æŒå¤šè½®å¯¹è¯ | æŒç»­åœ°åŠ å…¥ `user` å’Œ `assistant` äº¤äº’ï¼Œæ„å»ºå®Œæ•´çš„å¤šè½®å¯¹è¯å†å² |
| ğŸ”§ æ§åˆ¶è¡Œä¸º | `system` prompt å¯ç”¨æ¥æ§åˆ¶é£æ ¼ã€ä¸“ä¸šåº¦ã€é™åˆ¶è¾“å‡ºèŒƒå›´ï¼ˆå¦‚åªå›ç­”ä»£ç ã€ç”¨æŸç§è¯­è¨€ç­‰ï¼‰ |

ğŸ” ä¸€ä¸ªå®Œæ•´çš„å¯¹è¯ç¤ºä¾‹ï¼š

```json
[
  {
    "role": "system",
    "content": "You are a polite assistant who speaks like Shakespeare."
  },
  { "role": "user", "content": "What's the time?" },
  { "role": "assistant", "content": "The hour is late, fair traveler." },
  { "role": "user", "content": "What's the weather in Paris?" }
]
```

æ¨¡å‹ä¼šæ ¹æ®è¿™äº›æ¶ˆæ¯æ¥ç”Ÿæˆä¸‹ä¸€ä¸ª "assistant" çš„å›å¤ã€‚

âœ… æ€»ç»“
| è§’è‰² | ä½œç”¨ |
| ----------- | ----------------------- |
| `system` | è®¾å®šæ¨¡å‹çš„è¡Œä¸ºå’Œèº«ä»½ï¼Œé€šå¸¸åœ¨å¯¹è¯å¼€å¤´ä¸€æ¬¡æ€§ä½¿ç”¨ |
| `user` | è¡¨ç¤ºç”¨æˆ·è¾“å…¥ï¼Œæ„æˆå¯¹è¯çš„è¯·æ±‚éƒ¨åˆ† |
| `assistant` | æ¨¡å‹ç”Ÿæˆçš„å“åº”ï¼Œç”¨äºä¿æŒä¸Šä¸‹æ–‡å’Œå¤šè½®å¯¹è¯ |

è¿™ä¸‰ç±»è§’è‰²ç»„åˆèµ·æ¥ï¼Œä½¿å¾—å¯¹è¯å¯ä»¥å˜å¾—æœ‰é€»è¾‘ã€å¯æ§ã€å¤šè½®ä¸”é«˜åº¦ä¸Šä¸‹æ–‡æ„ŸçŸ¥ã€‚ä½ åœ¨æ„å»º agent æˆ–å¤šè½®èŠå¤©ç³»ç»Ÿæ—¶ï¼Œåˆç†ä½¿ç”¨å®ƒä»¬æ˜¯éå¸¸å…³é”®çš„ã€‚

### ä¸ºä»€ä¹ˆè¿™ä¸ªâ€œtool-calling agentâ€å¯ä»¥è¢«ç§°ä¸º AI agent

âœ… ä»€ä¹ˆæ˜¯ AI Agentï¼Ÿ
åœ¨äººå·¥æ™ºèƒ½é¢†åŸŸï¼ŒAI agent æŒ‡çš„æ˜¯ï¼šä¸€ä¸ªèƒ½å¤Ÿæ„ŸçŸ¥ç¯å¢ƒã€åšå‡ºå†³ç­–å¹¶é‡‡å–è¡ŒåŠ¨ä»¥å®ç°ç›®æ ‡çš„ç³»ç»Ÿã€‚

è¿™ä¸ªå®šä¹‰æ¥æºäºç»å…¸çš„äººå·¥æ™ºèƒ½æ•™æï¼ˆå¦‚ Russell & Norvig çš„ Artificial Intelligence: A Modern Approachï¼‰ã€‚

ä¸€ä¸ª AI agent å…·å¤‡ä»¥ä¸‹æ ¸å¿ƒç‰¹å¾ï¼š
| ç‰¹å¾ | æè¿° |
| --------------- | ----------------------- |
| æ„ŸçŸ¥ï¼ˆPerceiveï¼‰ | èƒ½æ¥æ”¶è¾“å…¥ï¼ˆä¾‹å¦‚ç”¨æˆ·æŒ‡ä»¤ã€æ•°æ®ã€ä¸Šä¸‹æ–‡ï¼‰ |
| å†³ç­–ï¼ˆReason/Planï¼‰ | èƒ½æ ¹æ®è¾“å…¥é€‰æ‹©åˆé€‚çš„ç­–ç•¥æˆ–å·¥å…· |
| è¡ŒåŠ¨ï¼ˆActï¼‰ | æ‰§è¡ŒæŸç§è¡Œä¸ºï¼Œä¾‹å¦‚å›ç­”é—®é¢˜ã€è°ƒç”¨å·¥å…·ã€è¿”å›ç»“æœ |
| åé¦ˆï¼ˆReact/Learnï¼‰ | æœ‰æ—¶è¿˜èƒ½æ ¹æ®ç»“æœè¿›è¡Œè‡ªæˆ‘è°ƒæ•´ï¼ˆå¯é€‰ï¼‰ |

âœ… Tool-Calling Agent æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ
ä»¥ä½ æåˆ°çš„â€œtool-calling agentâ€ï¼ˆä¾‹å¦‚ä½¿ç”¨ OpenAI Function Calling æˆ– LangChain agentï¼‰ä¸ºä¾‹ï¼š

1. æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼šå¦‚ "What's the weather in Tokyo?"

2. åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·ï¼ˆæ„ŸçŸ¥ + æ¨ç†ï¼‰ï¼šåˆ¤æ–­ç”¨æˆ·çš„é—®é¢˜ä¸æ˜¯ç›´æ¥å›ç­”ï¼Œè€Œæ˜¯è¦è°ƒç”¨ get_weather() å·¥å…·

3. æ„é€  API è°ƒç”¨å¹¶æ‰§è¡Œï¼ˆè¡ŒåŠ¨ï¼‰ï¼šå‘å¤©æ°”å·¥å…·å‘èµ·æŸ¥è¯¢

4. æ•´åˆç»“æœå¹¶è¾“å‡ºï¼ˆå®Œæˆä»»åŠ¡ï¼‰ï¼šè¿”å› "The current weather in Tokyo is 25Â°C and sunny."

ğŸ‘‰ å®ƒç†è§£ç›®çš„ã€é€‰æ‹©æ–¹æ³•ã€è°ƒç”¨å·¥å…·ã€å®Œæˆä»»åŠ¡ï¼Œè¿™å°±æ˜¯â€œä»£ç†ï¼ˆagentï¼‰â€çš„å…¸å‹æ¨¡å¼ã€‚

âœ… æ‰€ä»¥ï¼Œtool-calling agent æ˜¯ AI agent å—ï¼Ÿ
æ˜¯çš„ï¼Œå› ä¸ºå®ƒç¬¦åˆ AI agent çš„å®šä¹‰ï¼š

- å®ƒèƒ½è‡ªåŠ¨å†³å®šä½•æ—¶ä½¿ç”¨å·¥å…·
- å®ƒèƒ½æ„ŸçŸ¥ç”¨æˆ·çš„æ„å›¾
- å®ƒèƒ½é‡‡å–è¡ŒåŠ¨æ¥å®ç°ç›®æ ‡ï¼ˆè°ƒç”¨å·¥å…·ï¼‰
- å®ƒä½“ç°äº†â€œæ€è€ƒ â†’ è¡ŒåŠ¨â€çš„ loop

è¿™ç±» agent å¹¶ä¸æ˜¯æ­»æ¿çš„è„šæœ¬ï¼Œè€Œæ˜¯å…·å¤‡ä¸€å®šâ€œæ™ºèƒ½â€çš„è¡Œä¸ºåè°ƒå™¨ã€‚

ğŸ” ä¸¾ä¸ªæ¯”å–»ï¼š
æŠŠ AI agent æƒ³è±¡æˆä¸€ä¸ªåŠ©ç†ï¼š

ä½ è¯´ï¼šâ€œè®¢ä¸ªæŠ«è¨ç»™æˆ‘ã€‚â€
åŠ©ç†åˆ†æï¼šâ€œè¿™ä¸æ˜¯æˆ‘èƒ½ç›´æ¥å›ç­”çš„é—®é¢˜ï¼Œæˆ‘è¦è°ƒç”¨å¤–å– appã€‚â€
ç„¶åå» app ä¸‹å•ï¼Œå¹¶å‘Šè¯‰ä½ â€œå·²ä¸‹å•ï¼Œ30 åˆ†é’Ÿé€è¾¾â€ã€‚

è¿™å°±æ˜¯ AI agent çš„ä½“ç°ï¼Œè€Œ tool-calling å°±æ˜¯å®ƒâ€œæ‰“ç”µè¯è®¢é¤â€çš„èƒ½åŠ›ã€‚
